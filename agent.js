import { Agent } from "credential-agent-procivis";

const config = {
  project_name: process.env.IPS_PROJECT_NAME || "ips-demo",
  api_base: process.env.IPS_API_BASE || "https://procivis.sandbox.findy.fi/api",
  api_token: process.env.IPS_API_TOKEN || "",
  token_endpoint:
    process.env.IPS_TOKEN_ENDPOINT ||
    "https://keycloak.trial.procivis-one.com/realms/trial/protocol/openid-connect/token",
  client_id: process.env.IPS_CLIENT_ID || "",
  client_secret: process.env.IPS_CLIENT_SECRET || "",
  server_host: process.env.IPS_SERVER_HOST || "localhost",
  issuer_url: process.env.IPS_ISSUER_HOST || "ips-demo.trustregistry.eu",
  vct_id: process.env.IPS_VCT_ID || "https://ips.todiste.fi/credentials/v1/PatientSummary",
  vct_url: process.env.IPS_VCT_URL || "https://ips.todiste.fi/credentials/v1/PatientSummary.json",
};

const agentParams = {
  api_base: config.api_base,
};
const authParams = {};
if (config.api_token) {
  authParams.api_token = config.api_token;
} else if (config.client_id && config.client_secret) {
  authParams.client_id = config.client_id;
  authParams.client_secret = config.client_secret;
  authParams.token_endpoint = config.token_endpoint;
} else {
  throw new Error("No authentication method configured!");
}
const agent = new Agent(agentParams);
await agent.authenticate(authParams);
await agent.setOrganization(await initOrg());
agent.keys = [await initKey()];
agent.dids = [await initDID(agent.keys[0])];
agent.schemas.credential = await initCredentialSchema();
agent.schemas.proof = await initVerificationSchema();

export { agent };

async function initOrg() {
  const list = await agent.getOrganizations();
  let o;
  if (list && list.values && list.values.length > 0) {
    o = list.values.at(0);
  } else if (typeof list === typeof []) {
    o = list.at(0);
  }
  if (!o) {
    o = await agent.createOrganization({ name: config.issuer_url });
  }
  return o;
}

async function initKey() {
  let key = {};
  const list = await agent.getKeys({ name: config.project_name });
  const id = list?.values?.at(0)?.id; // use the first returned
  if (id) {
    key = list?.values?.at(0);
  } else {
    const data = {
      keyType: "ECDSA",
      keyParams: {},
      name: config.project_name,
      storageType: "INTERNAL",
      storageParams: {},
    };
    key = await agent.createKey(data);
    console.log("New key: ", key);
  }
  return key?.id;
}

async function initDID(key) {
  const listParams = {
    "didMethods[]": "WEB",
    name: config.issuer_url,
    sort: "createdDate",
    sortDirection: "DESC",
  };
  const list = await agent.getDIDs(listParams);
  const id = list?.values?.at(0)?.id; // use the first returned
  if (id) {
    const identifier = await agent.getDID(id);
    // console.log(JSON.stringify(identifier, null, 2))
    return identifier?.did?.id;
  } else {
    const data = {
      name: config.issuer_url,
      method: "WEB",
      keys: {
        authentication: [key],
        assertionMethod: [key],
        keyAgreement: [key],
        capabilityInvocation: [key],
        capabilityDelegation: [key],
      },
      params: {
        externalHostingUrl: `https://${config.issuer_url}`,
      },
    };
    const identifier = await agent.createDID(data);
    return identifier?.did?.id;
  }
}

async function initCredentialSchema() {
  const list = await agent.getCredentialSchemas({
    name: "IPS",
    format: "SD_JWT_VC",
  });
  const id = list?.values?.at(0)?.id || null; // use the first returned
  let schema = {};
  if (id) {
    schema = await agent.getCredentialSchema(id);
  } else {
    let credentialSchema = {
      name: "IPS",
      format: "SD_JWT_VC",
      schemaType: "ProcivisOneSchema2024",
      schemaId: config.vct_id || config.vct_url,
      externalSchema: true,
      revocationMethod: "NONE",
      walletStorageType: "SOFTWARE",
      layoutType: "CARD",
      allowSuspension: false,
      claims: [],
      layoutProperties: {
        background: {
          color: "#0d0342",
        },
        logo: {
          image:
            "data:image/png;base64,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",
        },
        primaryAttribute: "Title",
        secondaryAttribute: "Author",
      },
    };
    const vct = await fetch(config.vct_url);
    const vctJson = await vct.json();
    const claims = vctJson.PatientSummary_SD_JWT_VC.claims;
    for (const claim of claims) {
      credentialSchema.claims.push({
        "key": claim.path[0],
        "required": false,
        "datatype": "STRING",
        "array": false
      });      
    }
    const res = await agent.createCredentialSchema(credentialSchema);
    schema = await agent.getCredentialSchema(res.id);
  }
  return schema;
}

async function initVerificationSchema() {
  const list = await agent.getVerificationSchemas({
    name: agent.schemas.credential.name,
  });
  const pid = list?.values?.at(0)?.id; // use the first returned
  let schema = {};
  if (pid) {
    schema = await agent.getVerificationSchema(pid);
  } else {
    const cs = agent.schemas.credential;
    const proofSchema = {
      name: cs.name,
      expireDuration: 0,
      proofInputSchemas: [
        {
          credentialSchemaId: cs.id,
          claimSchemas: [],
        },
      ],
    };
    cs.claims.forEach((claim) => {
      proofSchema.proofInputSchemas[0].claimSchemas.push({
        id: claim.id,
        required: true,
      });
    });
    schema = await agent.createVerificationSchema(proofSchema);
  }
  return schema;
}

async function clearSchemas() {
  let list = await agent.getCredentialSchemas();
  for (const item of list?.values || []) {
    await agent.deleteCredentialSchema(item.id);
  }
  list = await agent.getVerificationSchemas();
  for (const item of list?.values || []) {
    await agent.deleteVerificationSchema(item.id);
  }
}
